# 帶有情緒模組的聊天機器人之實作

> 中央大學專題實驗

## 目標

1. 新增額外的情感模組，使模型能以類似人類的方式處理情緒
2. 使模型能具有自己的情感或近似的狀態

## 使用技術

- chatbot
    - 模型：LLaMA2
    - 模型訓練：PyTorch 2、Peft、Trl
    - 模型部署：torchserve
- 互動前端
    - Vue

## 模型架構

### 整體架構

#### 構想

設定一情緒表徵作為模型自身情緒上最理想的狀態，則情緒模組之目的是使自身目前的情緒表徵盡可能相似於理想的表徵。
由於情緒表徵隨時會受使用者輸入影響，應不可能達成與理想表徵完全一致的狀態，
因此透過情緒模組在產生回應情緒上的不確定性，預期能達成近似於模型自身具有感情的效果。

#### 機制

<img src="Model_Architecture.png" width = "250" height = "548" alt="Model Architecture"/>
  
模組本身會執行三大步驟，依序為辨識情緒、處理情緒、產生情緒。
  
- **辨識情緒**

  此步驟直接使用 Daily Dialog 資料集來微調 LLM 進行 Sentimental Analysis，
  對輸入的語句進行分析後回傳在 Daily Dialog 資料集中使用的 8 種基本情緒的文字型態標籤（ $U_n$ ），後續在模組中直接使用。
- **處理情緒**<br>

  此處分為兩個子模組進行處理，同理心子模組（Empathy Model）與情緒子模組（Emotion Model）。
  分為兩個模組的目的是為了讓模型以類似人類的方式應對情緒，情緒刺激會對人類有長期和短期的影響，而人類也會同理對方情緒作為應對的考量。
  
  - *同理心子模組（Empathy Model）*
    
    考量到人類在同理他人時也會參考先前的應對作為參考，此處使用情緒應對的歷史
    （包括當前輸入 $U_n$ 和作為候選應對的 8 種情緒標籤 $C_n'$ （也就是資料集中的 8 種情緒） ，因此會有總共 8 組歷史）作為輸入，
    並分別預測在這 8 種狀況下對方可能的回應情緒（ $U_{n+1}'$ ）。此處的輸出會再作為情緒子模組第一次的輸入。
  - *情緒子模組（Emotion Model）*
    
    情緒子模組主要是反應情緒刺激的短期影響，輸入為當前的情緒輸入（ $U$ ），輸出為反映刺激的情緒表徵（ $E$ ）。
    

 

## 參考資料
